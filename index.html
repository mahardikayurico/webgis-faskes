<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aksesibilitas Fasilitas Kesehatan Kabupaten Barito Selatan</title>

    <!-- CDN Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Mapbox GL JS CDN -->
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.js"></script>

    <!-- Optional: Add custom styles for the map container -->
    <style>
      /* Peta akan mengisi seluruh halaman */
      #map {
        height: 50vh;
        width: 100%;
      }
      /* Panel kontrol di kanan atas */
      .layer-control {
        position: absolute;
        bottom: 30px;
        right: 10px;
        background: rgba(255, 255, 255, 0.7);
        padding: 10px;
        border-radius: 5px;
        z-index: 999;
      }
      .layer-control input {
        margin-right: 5px;
      }

      /* Legend tetap */
      #legend {
        width: 220px;
      }

      /* Responsive for mobile and tablet */
      @media (max-width: 768px) {
        .layer-control {
          padding: 6px;
          width: 160px;
        }

        .layer-control div {
          margin-bottom: 6px;
        }

        .layer-control input {
          height: 16px;
          width: 16px;
        }

        .layer-control img {
          width: 16px;
          height: 16px;
        }

        .layer-control label {
          font-size: 10px;
        }

        #legend {
          padding: 6px;
          width: 160px;
          font-size: 10px;
          bottom: 18rem;
        }

        #legend h3 {
          font-size: 12px;
        }

        #legend span {
          font-size: 10px;
        }
      }
      @media (max-width: 640px) {
        #map-title h2 {
          font-size: 12px;
        }
      }
    </style>
  </head>

  <body class="font-sans bg-gray-300">
    <!-- Sidebar Header -->
    <div
      id="sidebar"
      class="fixed top-4 left-4 z-50 w-64 h-[90%] bg-white/30 backdrop-blur-md shadow-2xl rounded-3xl p-6 flex flex-col items-center space-y-6 transition-all duration-500 overflow-hidden"
    >
      <!-- Logo -->
      <div
        id="logo"
        class="w-16 h-16 rounded-full shadow-md transition-all duration-500 overflow-hidden p-0"
      >
        <img
          src="assets/logo.png"
          alt="Logo K7"
          class="w-full h-full object-cover"
        />
      </div>

      <!-- Navigation Buttons -->
      <nav
        id="navMenu"
        class="flex flex-col w-full space-y-4 transition-all duration-500"
      >
        <button
          onclick="showPage('home')"
          class="menu-btn flex items-center space-x-3 px-4 py-2 text-gray-700 bg-white hover:bg-indigo-100 rounded-xl border border-gray-200 transition font-medium shadow-sm"
        >
          <svg
            class="w-5 h-5 text-indigo-500"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path
              d="M3 9l9-7 9 7v11a2 2 0 01-2 2h-4a2 2 0 01-2-2V12H9v8a2 2 0 01-2 2H3a2 2 0 01-2-2V9z"
            />
          </svg>
          <span class="menu-text">Home</span>
        </button>
        <button
          onclick="showPage('data-analisis')"
          class="menu-btn flex items-center space-x-3 px-4 py-2 text-gray-700 bg-white hover:bg-indigo-100 rounded-xl border border-gray-200 transition font-medium shadow-sm"
        >
          <svg
            class="w-5 h-5 text-indigo-500"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path d="M9 17v-6h13v6m-6-6V5h-7v6h7zm6 6v-6h-7v6h7z" />
          </svg>
          <span class="menu-text">Data & Analisis</span>
        </button>
        <button
          onclick="showPage('maps')"
          class="menu-btn flex items-center space-x-3 px-4 py-2 text-gray-700 bg-white hover:bg-indigo-100 rounded-xl border border-gray-200 transition font-medium shadow-sm"
        >
          <svg
            class="w-5 h-5 text-indigo-500"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path d="M1 6h2l2 14h12l2-14h2M5 6l2 14m4-14l2 14m4-14l2 14" />
          </svg>
          <span class="menu-text">Maps</span>
        </button>
      </nav>
    </div>

    <!-- Toggle Button -->
    <button
      id="toggleSidebarBtn"
      onclick="toggleSidebar()"
      class="fixed left-4 top-1/2 transform -translate-y-1/2 z-50 bg-indigo-500 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg transition-all duration-300"
    >
      <svg
        id="toggleIcon"
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        viewBox="0 0 24 24"
      >
        <path id="togglePath" d="M15 19l-7-7 7-7" />
      </svg>
    </button>

    <!-- Home Page Content -->
    <div
      id="home"
      class="px-6 md:px-20 py-10 flex flex-col items-center text-center space-y-12"
    >
      <!-- Banner atau Cover -->
      <div class="relative w-full overflow-hidden h-[80vh] md:h-[90vh]">
        <!-- Gambar background -->
        <img
          src="assets/images.png"
          alt="Peta Aksesibilitas"
          class="w-full h-full object-cover filter blur-sm"
        />

        <!-- Konten di atas gambar -->
        <div
          class="absolute inset-0 flex flex-col items-center justify-center text-center px-4"
        >
          <!-- Judul Besar -->
          <h2
            class="text-2xl sm:text-3xl md:text-5xl font-extrabold text-white leading-tight mb-6 drop-shadow-lg"
          >
            Aksesibilitas Fasilitas Kesehatan<br />Kabupaten Barito Selatan
          </h2>

          <!-- Tombol Mulai -->
          <a
            href="#maps"
            onclick="showPage('maps')"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 md:py-4 md:px-8 rounded-full text-base md:text-xl transition"
          >
            Start Explore Map
          </a>
        </div>
      </div>

      <!-- Intro Paragraph -->
      <p class="max-w-5xl text-gray-700 text-lg">
        Fasilitas kesehatan merupakan faktor penting dalam sistem kesehatan
        masyarakat. Namun, berbagai tantangan infrastruktur, kebijakan, dan
        faktor geografis masih menghambat pelayanan optimal kepada masyarakat.
      </p>

      <div class="w-full px-8 md:px-24 pt-8">
        <div class="max-w-6xl mx-auto">
          <h3 class="text-3xl font-bold text-indigo-600 mb-6">
            Identifikasi Permasalahan
          </h3>

          <div class="grid md:grid-cols-2 gap-8 text-left">
            <!-- Box per faktor -->
            <div
              class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition flex flex-col items-start"
            >
              <div class="text-4xl text-indigo-400 mb-4">üè•</div>
              <h4 class="text-xl font-semibold mb-2 text-indigo-500">
                Faktor Infrastruktur dan Teknologi
              </h4>
              <ul class="list-disc pl-5 text-gray-700">
                <li>Ketersediaan rumah sakit</li>
                <li>Penggunaan teknologi dalam sistem informasi kesehatan</li>
              </ul>
            </div>

            <div
              class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition flex flex-col items-start"
            >
              <div class="text-4xl text-indigo-400 mb-4">üèõÔ∏è</div>
              <h4 class="text-xl font-semibold mb-2 text-indigo-500">
                Faktor Kebijakan Pemerintah
              </h4>
              <ul class="list-disc pl-5 text-gray-700">
                <li>Regulasi dan pendanaan fasilitas kesehatan</li>
                <li>Dukungan program kesehatan untuk daerah terpencil</li>
              </ul>
            </div>

            <div
              class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition flex flex-col items-start"
            >
              <div class="text-4xl text-indigo-400 mb-4">üó∫Ô∏è</div>
              <h4 class="text-xl font-semibold mb-2 text-indigo-500">
                Faktor Geografis
              </h4>
              <ul class="list-disc pl-5 text-gray-700">
                <li>Jarak ke fasilitas kesehatan</li>
                <li>Ketersediaan transportasi menuju rumah sakit</li>
              </ul>
            </div>

            <div
              class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition flex flex-col items-start"
            >
              <div class="text-4xl text-indigo-400 mb-4">üë•</div>
              <h4 class="text-xl font-semibold mb-2 text-indigo-500">
                Faktor Sosial dan Ekonomi
              </h4>
              <ul class="list-disc pl-5 text-gray-700">
                <li>Biaya perawatan yang tinggi</li>
                <li>Kesadaran masyarakat terhadap layanan kesehatan</li>
              </ul>
            </div>
          </div>

          <!-- Masalah Spesifik -->
          <div class="mt-16">
            <h3 class="text-3xl font-bold text-indigo-600 mb-6">
              Masalah Spesifik
            </h3>

            <div class="grid md:grid-cols-2 gap-8 text-left">
              <div
                class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition flex flex-col items-start"
              >
                <div class="text-4xl text-red-400 mb-4">üè®</div>
                <h4 class="text-xl font-semibold text-red-500 mb-2">
                  Antrian Pasien dan Keterbatasan Ruang Rawat Inap
                </h4>
                <p class="text-gray-700 font-bold mb-2">Masalah :</p>
                <ul class="list-disc pl-5 text-gray-700 mb-4">
                  <li>Antrian pasien menyebabkan penundaan pelayanan.</li>
                  <li>
                    Keterbatasan kamar rawat inap membuat pasien sulit mendapat
                    layanan cepat.
                  </li>
                </ul>
                <p class="text-gray-700 font-bold mb-2">Dampak :</p>
                <ul class="list-disc pl-5 text-gray-700">
                  <li>Pasien kritis bisa mengalami kondisi memburuk.</li>
                  <li>Tenaga medis kewalahan dalam pelayanan.</li>
                </ul>
              </div>

              <div
                class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition flex flex-col items-start"
              >
                <div class="text-4xl text-red-400 mb-4">üöë</div>
                <h4 class="text-xl font-semibold text-red-500 mb-2">
                  Minimnya Pusat Trauma & Ketimpangan Akses Faskes
                </h4>
                <p class="text-gray-700 font-bold mb-2">Masalah :</p>
                <ul class="list-disc pl-5 text-gray-700 mb-4">
                  <li>
                    Kekurangan pusat trauma menghambat pertolongan korban
                    kecelakaan.
                  </li>
                  <li>
                    Akses ke rumah sakit sulit dan waktu emas ("golden hour")
                    terlewatkan.
                  </li>
                </ul>
                <p class="text-gray-700 font-bold mb-2">Dampak :</p>
                <ul class="list-disc pl-5 text-gray-700">
                  <li>Tingkat kematian akibat kecelakaan meningkat.</li>
                  <li>Beban rumah sakit rujukan bertambah berat.</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Solusi -->
          <div class="mt-16">
            <h3 class="text-3xl font-bold text-indigo-600 mb-6">
              Perancangan Solusi
            </h3>

            <p class="text-gray-700 mb-8 max-w-3xl">
              Solusi dikembangkan melalui pemanfaatan komputasi berbasis spasial
              untuk menganalisis dan meningkatkan aksesibilitas fasilitas
              kesehatan di Kabupaten Barito Selatan.
            </p>

            <div class="flex flex-wrap justify-center gap-6">
              <div
                class="bg-indigo-100 text-indigo-800 px-6 py-4 rounded-full shadow-sm"
              >
                Persebaran Fasilitas Kesehata
              </div>
              <div
                class="bg-indigo-100 text-indigo-800 px-6 py-4 rounded-full shadow-sm"
              >
                Populasi Penduduk
              </div>
              <div
                class="bg-indigo-100 text-indigo-800 px-6 py-4 rounded-full shadow-sm"
              >
                Jaringan Jalan
              </div>
              <div
                class="bg-indigo-100 text-indigo-800 px-6 py-4 rounded-full shadow-sm"
              >
                Data DEMNAS
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Data & Analisis Content -->
    <div id="data-analisis" class="p-8 hidden space-y-16">
      <!-- Section: Banner Atas -->
      <div
        class="relative max-w-6xl mx-auto bg-gradient-to-r from-indigo-100 via-white to-indigo-100 rounded-3xl shadow-xl overflow-hidden"
      >
        <div class="grid md:grid-cols-2 gap-6 items-center p-10">
          <div class="space-y-4">
            <h2 class="text-3xl font-extrabold text-indigo-700 leading-tight">
              Data dan Analisis Aksesibilitas
            </h2>
            <p class="text-gray-700 text-lg">
              Analisis spasial untuk memahami distribusi fasilitas kesehatan dan
              aksesibilitas masyarakat di Kabupaten Barito Selatan.
            </p>
          </div>
          <img
            src="assets/images3.webp"
            alt="Analisis Ilustrasi"
            class="w-full"
          />
        </div>
      </div>

      <!-- Section: Tools & Materials -->
      <div class="max-w-6xl mx-auto">
        <h3 class="text-2xl font-bold text-indigo-600 mb-8 text-center">
          Alat dan Bahan
        </h3>

        <div class="grid md:grid-cols-2 gap-10">
          <!-- Tools Card -->
          <div
            class="bg-white rounded-xl p-8 shadow-lg hover:shadow-2xl transition flex flex-col items-center space-y-4"
          >
            <!-- SVG Icon Tools -->
            <div
              class="w-20 h-20 rounded-full bg-indigo-100 flex items-center justify-center"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-10 h-10 text-indigo-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9.75 3h4.5c.69 0 1.25.56 1.25 1.25v2.5c0 .69-.56 1.25-1.25 1.25h-4.5c-.69 0-1.25-.56-1.25-1.25v-2.5C8.5 3.56 9.06 3 9.75 3zM4 7h16M4 11h16M4 15h16M4 19h16"
                />
              </svg>
            </div>

            <h4 class="text-xl font-semibold text-indigo-600">Tools</h4>
            <ul class="text-gray-700 list-disc pl-5 space-y-1 text-left">
              <li>Laptop</li>
              <li>Google Colab</li>
              <li>Visual Studio Code</li>
              <li>GitHub</li>
              <li>Vercel</li>
            </ul>
          </div>

          <!-- Materials Card -->
          <div
            class="bg-white rounded-xl p-8 shadow-lg hover:shadow-2xl transition flex flex-col items-center space-y-4"
          >
            <!-- SVG Icon Materials -->
            <div
              class="w-20 h-20 rounded-full bg-indigo-100 flex items-center justify-center"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-10 h-10 text-indigo-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17v-6h13v6m-6-6V5h-7v6h7zm6 6v-6h-7v6h7zM4 5v14c0 1.104.896 2 2 2h10"
                />
              </svg>
            </div>

            <h4 class="text-xl font-semibold text-indigo-600">Bahan</h4>
            <ul class="text-gray-700 list-disc pl-5 space-y-1 text-left">
              <li>Persebaran Fasilitas Kesehatan</li>
              <li>Populasi Penduduk</li>
              <li>Data DEMNAS</li>
              <li>Jaringan Jalan</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Section: Lokasi Mini Project -->
      <div class="max-w-6xl mx-auto text-center space-y-6">
        <h3 class="text-2xl font-bold text-indigo-600">Lokasi Mini Project</h3>
        <p class="text-gray-700 max-w-3xl mx-auto">
          Kabupaten Barito Selatan dipilih karena memiliki variasi kondisi medan
          (slope), keterbatasan dokumentasi aksesibilitas fasilitas kesehatan,
          dan kebutuhan untuk mendukung kebijakan lokal berbasis data spasial.
        </p>
        <img
          src="assets/peta-wilayah.webp"
          alt="Peta Lokasi"
          class="w-1/2 mx-auto"
        />
      </div>

      <!-- Section: Data dan Metode -->
      <div class="max-w-6xl mx-auto space-y-8">
        <h3 class="text-2xl font-bold text-indigo-600 text-center">
          Data dan Metode
        </h3>

        <div class="grid md:grid-cols-2 gap-8">
          <!-- Persebaran Fasilitas Kesehatan -->
          <div
            class="flex items-start space-x-4 bg-white p-6 rounded-xl shadow hover:shadow-2xl transition"
          >
            <div
              class="w-16 h-16 flex items-center justify-center rounded-full bg-indigo-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-indigo-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M18 8a6 6 0 00-12 0c0 7-3 9-3 9h18s-3-2-3-9zM8 21h8"
                />
              </svg>
            </div>
            <div>
              <h4 class="text-indigo-600 font-semibold text-lg mb-2">
                Persebaran Fasilitas Kesehatan
              </h4>
              <p class="text-gray-700 text-sm">
                Identifikasi lokasi faskes sebagai tujuan utama analisis
                aksesibilitas.
              </p>
            </div>
          </div>

          <!-- Data Jaringan Jalan -->
          <div
            class="flex items-start space-x-4 bg-white p-6 rounded-xl shadow hover:shadow-2xl transition"
          >
            <div
              class="w-16 h-16 flex items-center justify-center rounded-full bg-indigo-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-indigo-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 10h16M4 14h16M4 18h16"
                />
              </svg>
            </div>
            <div>
              <h4 class="text-indigo-600 font-semibold text-lg mb-2">
                Data Jaringan Jalan
              </h4>
              <p class="text-gray-700 text-sm">
                Jaringan jalan dikonversi menjadi graph untuk analisis rute
                terpendek menggunakan algoritma Dijkstra.
              </p>
            </div>
          </div>

          <!-- Populasi Penduduk -->
          <div
            class="flex items-start space-x-4 bg-white p-6 rounded-xl shadow hover:shadow-2xl transition"
          >
            <div
              class="w-16 h-16 flex items-center justify-center rounded-full bg-indigo-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-indigo-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a4 4 0 00-5-4h-1M9 20H4v-2a4 4 0 015-4h1M12 4a4 4 0 11-8 0 4 4 0 018 0zm8 4a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
            </div>
            <div>
              <h4 class="text-indigo-600 font-semibold text-lg mb-2">
                Populasi Penduduk
              </h4>
              <p class="text-gray-700 text-sm">
                Data populasi digunakan untuk memperhitungkan beban akses jalan
                dan kapasitas fasilitas kesehatan.
              </p>
            </div>
          </div>

          <!-- Data DEMNAS (Slope) -->
          <div
            class="flex items-start space-x-4 bg-white p-6 rounded-xl shadow hover:shadow-2xl transition"
          >
            <div
              class="w-16 h-16 flex items-center justify-center rounded-full bg-indigo-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-indigo-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 17l6-6 4 4 8-8"
                />
              </svg>
            </div>
            <div>
              <h4 class="text-indigo-600 font-semibold text-lg mb-2">
                Data DEMNAS (Slope)
              </h4>
              <p class="text-gray-700 text-sm">
                Nilai kemiringan jalan dari DEMNAS digunakan untuk mempengaruhi
                estimasi waktu tempuh.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Section: Library Python dan WebGIS -->
      <!-- Section: Library Python dan WebGIS -->
      <div class="max-w-6xl mx-auto mt-16 px-4">
        <h3 class="text-2xl font-bold text-indigo-600 mb-6 text-center">
          Library yang Digunakan
        </h3>
        <div class="grid md:grid-cols-2 gap-10">
          <!-- Kolom Python -->
          <div>
            <h4 class="text-lg font-semibold text-indigo-700 mb-3">
              Python untuk Analisis Spasial:
            </h4>
            <ul class="list-disc pl-5 text-gray-700 space-y-1">
              <li>
                <span class="font-semibold text-green-600">GeoPandas</span> ‚Äì
                Membaca dan mengolah data spasial (vektor).
              </li>
              <li>
                <span class="font-semibold text-yellow-600">Shapely</span> ‚Äì
                Analisis geometri spasial (misalnya titik dalam poligon,
                pemotongan geometri).
              </li>
              <li>
                <span class="font-semibold text-orange-600">NetworkX</span> ‚Äì
                Analisis jaringan jalan menggunakan graf.
              </li>
              <li>
                <span class="font-semibold text-gray-700">OSMnx</span> ‚Äì
                Mendapatkan data jaringan jalan dari OpenStreetMap.
              </li>
              <li>
                <span class="font-semibold text-green-700">Rasterio</span> ‚Äì
                Membaca data raster, seperti slope dari DEMNAS.
              </li>
              <li>
                <span class="font-semibold text-blue-700">Rasterstats</span> ‚Äì
                Mengambil nilai raster pada titik atau poligon tertentu.
              </li>
              <li>
                <span class="font-semibold text-purple-700">NumPy</span> ‚Äì
                Perhitungan numerik yang efisien.
              </li>
              <li>
                <span class="font-semibold text-pink-600">Pandas</span> ‚Äì
                Manipulasi data tabular, seperti join dan filtering.
              </li>
              <li>
                <span class="font-semibold text-indigo-600">Matplotlib</span> ‚Äì
                Visualisasi data spasial dalam bentuk grafik.
              </li>
              <li>
                <span class="font-semibold text-green-500">Folium</span> ‚Äì
                Visualisasi data interaktif berbasis leaflet.
              </li>
            </ul>
          </div>

          <!-- Kolom WebGIS -->
          <div>
            <h4 class="text-lg font-semibold text-indigo-700 mb-3">
              Library untuk WebGIS & Deployment:
            </h4>
            <ul class="list-disc pl-5 text-gray-700 space-y-1">
              <li>
                <span class="font-semibold text-blue-600">Mapbox GL JS</span> ‚Äì
                Visualisasi spasial interaktif di browser.
              </li>
              <li>
                <span class="font-semibold text-cyan-600">Tailwind CSS</span> ‚Äì
                Styling antarmuka yang modern dan responsif.
              </li>
              <li>
                <span class="font-semibold text-black">Vercel</span> ‚Äì Platform
                untuk hosting dan deployment WebGIS secara cepat dan gratis.
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Section: Proses Data Gambar -->
      <div class="max-w-6xl mx-auto">
        <h3 class="text-2xl font-bold text-indigo-600 mb-6 text-center">
          Tahapan Proses Data
        </h3>
        <img
          src="assets/diagramalir.png"
          alt="Peta Lokasi"
          class="w-1/2 mx-auto"
        />
      </div>

      <!-- Section: Final WebGIS -->
      <div class="max-w-6xl mx-auto text-center mt-16">
        <h3 class="text-2xl font-bold text-indigo-600 mb-4">
          Visualisasi Akhir WebGIS
        </h3>
        <p class="text-gray-700 mb-8">
          Semua hasil analisis ditampilkan dalam WebGIS interaktif untuk
          memudahkan eksplorasi spasial dan mendukung pengambilan keputusan
          berbasis data.
        </p>
        <a
          href="#maps"
          onclick="showPage('maps')"
          class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition"
        >
          Start Explore Map
        </a>
      </div>
    </div>

    <!-- Map Container -->
    <!-- <div id="map"></div> -->
    <!-- Map Container -->
    <div id="maps" class="hidden w-full" style="height: 100dvh">
      <!-- Judul dalam peta -->
      <div
        id="map-title"
        class="absolute top-4 left-1/2 transform -translate-x-1/2 z-50 bg-white/70 backdrop-blur-md px-4 py-2 rounded-md shadow-md text-center"
      >
        <h2
          class="text-base sm:text-lg md:text-xl font-semibold text-indigo-700"
        >
          Peta Aksesibilitas Fasilitas Kesehatan Kabupaten Barito Selatan
        </h2>
      </div>

      <div id="map" class="w-full" style="height: 100dvh"></div>
      <div
        id="legend"
        class="absolute bottom-[16rem] right-2 bg-white p-4 rounded shadow text-xs z-50"
      >
        <h3 class="font-semibold mb-2">Keterangan Aksesibilitas</h3>
        <div
          class="w-54 h-4 mb-2 rounded"
          style="
            background: linear-gradient(
              to right,
              rgb(255, 0, 0) 0%,
              rgb(255, 255, 0) 50%,
              rgb(0, 0, 255) 100%
            );
          "
        ></div>
        <div class="flex justify-between text-gray-700 mb-2">
          <span class="mx-2">Akses Buruk</span>
          <span class="mx-2">Akses Sedang</span>
          <span class="mx-2">Akses Baik</span>
        </div>
        <div class="mb-2">
          <label for="minScore" class="block text-gray-700"
            >Skor Minimum:</label
          >
          <input
            type="range"
            id="minScore"
            min="0"
            max="1"
            step="0.01"
            value="0"
            class="w-full"
          />
          <span id="minScoreValue" class="text-gray-700">0</span>
        </div>
        <div class="mb-2">
          <label for="maxScore" class="block text-gray-700"
            >Skor Maksimum:</label
          >
          <input
            type="range"
            id="maxScore"
            min="0"
            max="1"
            step="0.01"
            value="1"
            class="w-full"
          />
          <span id="maxScoreValue" class="text-gray-700">1</span>
        </div>
        <button
          id="resetFilter"
          class="mt-2 px-4 py-1 bg-blue-500 text-white rounded"
        >
          Tampilkan Semua
        </button>
      </div>

      <!-- <div
        id="legend"
        class="absolute bottom-[16rem] right-2 bg-white p-4 rounded shadow text-xs z-50"
      >
        <h3 class="font-semibold mb-2">Keterangan Aksesibilitas</h3>
        <div
          class="w-54 h-4 mb-2 rounded"
          style="
            background: linear-gradient(
              to right,
              rgb(255, 0, 0) 0%,
              rgb(255, 255, 0) 50%,
              rgb(0, 0, 255) 100%
            );
          "
        ></div>
        <div class="flex justify-between text-gray-700">
          <span class="mx-2">Akses Buruk</span>
          <span class="mx-2">Akses Sedang</span>
          <span class="mx-2">Akses Baik</span>
        </div>
      </div> -->
      <div
        id="layer-control"
        class="absolute bottom-4 right-2 bg-white bg-opacity-80 p-4 rounded-lg shadow text-xs z-50 hidden"
      >
        <!-- Checkbox layers akan diisi lewat JS -->
      </div>
      <div class="absolute bottom-7 left-4 z-50 flex">
        <button
          onclick="toggleBasemapMenu()"
          class="bg-white shadow px-3 py-2 border border-black rounded-lg text-xs justify-center items-center gap-2 hover:bg-indigo-100"
        >
          <img src="assets/lapisan.webp" class="w-8 h-8" alt="icon" />
        </button>

        <div
          id="basemap-control"
          class="ml-2 bg-white/90 p-3 rounded-lg shadow text-xs space-y-2 w-[11rem] sm:w-[17rem] hidden"
        >
          <div class="grid grid-cols-5 gap-2">
            <img
              id="basemap-satellite"
              src="assets/satelite.png"
              alt="Satellite"
              class="basemap-img cursor-pointer rounded shadow w-8 h-8"
              onclick="switchBasemap('mapbox/satellite-streets-v11', 'basemap-satellite')"
            />
            <img
              id="basemap-streets"
              src="assets/street.png"
              alt="Streets"
              class="basemap-img cursor-pointer rounded shadow w-8 h-8"
              onclick="switchBasemap('mapbox/streets-v11', 'basemap-streets')"
            />
            <img
              id="basemap-outdoors"
              src="assets/outdor.png"
              alt="Outdoors"
              class="basemap-img cursor-pointer rounded shadow w-8 h-8"
              onclick="switchBasemap('mapbox/outdoors-v11', 'basemap-outdoors')"
            />
            <img
              id="basemap-light"
              src="assets/light.png"
              alt="Light"
              class="basemap-img cursor-pointer rounded shadow w-8 h-8"
              onclick="switchBasemap('mapbox/light-v10', 'basemap-light')"
            />
            <img
              id="basemap-dark"
              src="assets/dark.png"
              alt="Dark"
              class="basemap-img cursor-pointer rounded shadow w-8 h-8"
              onclick="switchBasemap('mapbox/dark-v10', 'basemap-dark')"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Script to initialize Mapbox and add GeoJSON heatmap -->
    <script>
      let isCollapsed = false;

      function isMobileOrTablet() {
        return window.innerWidth <= 768; // Sesuaikan threshold (768px untuk mobile/tablet)
      }

      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const togglePath = document.getElementById("togglePath");
        const logo = document.getElementById("logo");
        const navMenu = document.getElementById("navMenu");

        if (isMobileOrTablet()) {
          // Untuk Mobile & Tablet ‚ûî langsung hide/show sidebar full
          if (sidebar.classList.contains("hidden")) {
            sidebar.classList.remove("hidden");
            togglePath.setAttribute("d", "M15 19l-7-7 7-7"); // Panah kiri
          } else {
            sidebar.classList.add("hidden");
            togglePath.setAttribute("d", "M9 5l7 7-7 7"); // Panah kanan
          }
        } else {
          // Untuk Desktop ‚ûî Collapsing seperti biasa
          if (isCollapsed) {
            sidebar.classList.remove("w-10");
            sidebar.classList.add("w-64");
            logo.classList.remove("hidden");
            navMenu.classList.remove("hidden");
            togglePath.setAttribute("d", "M15 19l-7-7 7-7"); // Panah kiri
            isCollapsed = false;
          } else {
            sidebar.classList.remove("w-64");
            sidebar.classList.add("w-10");
            logo.classList.add("hidden");
            navMenu.classList.add("hidden");
            togglePath.setAttribute("d", "M9 5l7 7-7 7"); // Panah kanan
            isCollapsed = true;
          }
        }
      }

      // function toggleSidebar() {
      //   const sidebar = document.getElementById("sidebar");
      //   const togglePath = document.getElementById("togglePath");
      //   const logo = document.getElementById("logo");
      //   const navMenu = document.getElementById("navMenu");

      //   if (isCollapsed) {
      //     // Expand Sidebar
      //     sidebar.classList.remove("w-10");
      //     sidebar.classList.add("w-64");
      //     logo.classList.remove("hidden");
      //     navMenu.classList.remove("hidden");
      //     togglePath.setAttribute("d", "M15 19l-7-7 7-7"); // panah ke kiri
      //     isCollapsed = false;
      //   } else {
      //     // Collapse Sidebar
      //     sidebar.classList.remove("w-64");
      //     sidebar.classList.add("w-10");
      //     logo.classList.add("hidden");
      //     navMenu.classList.add("hidden");
      //     togglePath.setAttribute("d", "M9 5l7 7-7 7"); // panah ke kanan
      //     isCollapsed = true;
      //   }
      // }
      function showPage(page) {
        // Sembunyikan semua div
        document.getElementById("home").classList.add("hidden");
        document.getElementById("data-analisis").classList.add("hidden");
        document.getElementById("maps").classList.add("hidden");

        // Tampilkan div yang dipilih
        document.getElementById(page).classList.remove("hidden");

        // Kalau maps yang dibuka, paksa resize
        if (page === "maps" && map) {
          map.resize();
        }
      }

      // Set default tampilkan Home
      showPage("home");
      // Peta Mapbox
      mapboxgl.accessToken =
        "pk.eyJ1IjoibWFoYXJkaWtheXVyaWNvYmlsbGlhbiIsImEiOiJjbTdrcDk1YXIwMzcyMmtweGlpbHFvb3JwIn0.TDtP3iZj6oKYY2RPFbtLZA"; // Ganti dengan Mapbox API Key Anda
      // Basemap Switcher
      // const basemapSelector = document.getElementById("basemap-selector");
      // basemapSelector.addEventListener("change", function () {
      //   const newStyle = `mapbox://styles/${this.value}`;
      //   map.setStyle(newStyle);
      //   // TODO: re-add layers and sources after style load if necessary
      // });

      var map = new mapboxgl.Map({
        container: "map", // ID container div
        // style: "mapbox://styles/mapbox/streets-v11", // Gaya peta
        style: "mapbox://styles/mapbox/satellite-streets-v11",
        center: [115.0, -1.8], // Koordinat pusat peta (longitude, latitude)
        zoom: 8, // Tingkat zoom
      });

      function switchBasemap(styleId, selectedId) {
        const newStyle = `mapbox://styles/${styleId}`;
        map.setStyle(newStyle);

        // Hapus semua border biru dulu
        document.querySelectorAll(".basemap-img").forEach((img) => {
          img.classList.remove("ring", "ring-2", "ring-blue-500");
        });

        // Tambahkan border ke yang dipilih
        const selectedImg = document.getElementById(selectedId);
        if (selectedImg) {
          selectedImg.classList.add("ring", "ring-2", "ring-blue-500");
        }
      }

      function toggleBasemapMenu() {
        const control = document.getElementById("basemap-control");
        control.classList.toggle("hidden");
      }
      // Menambahkan kontrol peta (zoom, layar penuh, dll)
      map.addControl(new mapboxgl.NavigationControl());

      map.on("style.load", function () {
        map.addSource("geojson-output", {
          type: "geojson",
          data: "assets/geojson_output.geojson", // Path ke file GeoJSON
        });

        // Menambahkan Layer untuk titik-titik (circle) dengan gradasi warna
        map.addLayer({
          id: "points-layer",
          type: "circle",
          source: "geojson-output",
          layout: {
            visibility: "visible",
          },
          paint: {
            "circle-radius": 30,
            "circle-color": [
              "interpolate",
              ["linear"],
              ["to-number", ["get", "skor_total"]],
              0,
              "rgb(0, 0, 255)",
              0.1,
              "rgb(255, 0, 0)",
              0.5,
              "rgb(255, 255, 0)",
              1,
              "rgb(0, 0, 255)",
            ],
            "circle-opacity": 0.9,
            "circle-blur": 0.9,
          },
        });

        // Menambahkan Source untuk administrasi_wilayah.geojson (data wilayah dengan jumlah penduduk)
        map.addSource("administrasi-wilayah", {
          type: "geojson",
          data: "assets/administrasi_wilayah.geojson", // Path ke file GeoJSON wilayah
        });

        // Menambahkan Layer untuk menampilkan hanya garis polygon (bukan fill)
        map.addLayer({
          id: "administrasi-wilayah-layer",
          type: "line", // ganti type ke line
          source: "administrasi-wilayah",
          layout: {
            visibility: "visible",
          },
          paint: {
            "line-color": "#000", // warna coklat (saddle brown)
            "line-width": 1, // ketebalan garis
          },
        });

        // Menambahkan Label Nama Desa + Jumlah Penduduk
        map.addLayer({
          id: "administrasi-wilayah-label",
          type: "symbol",
          source: "administrasi-wilayah",
          layout: {
            "text-field": [
              "format",
              ["get", "WADMKD"],
              { "font-scale": 1.2 },
              "\n",
              "Jumlah Penduduk: ",
              { "font-scale": 1 }, // Tambahkan teks keterangan statis
              ["get", "jumlah_penduduk"],
              { "font-scale": 1 },
            ],
            "text-font": ["Open Sans Bold", "Arial Unicode MS Bold"],
            "text-size": 8,
            "text-offset": [0, 0],
            "text-anchor": "center",
            visibility: "visible",
          },
          paint: {
            "text-color": "#ffffff", // abu gelap (biar tetap terlihat)
            "text-halo-color": "#000",
            "text-halo-width": 1.5,
          },
        });

        // Menambahkan Source untuk jalan_slope.geojson (data jalan)
        map.addSource("jalan-slope", {
          type: "geojson",
          data: "assets/jalan_slope.geojson", // Path ke file GeoJSON jalan
        });

        // Menambahkan Layer untuk jalan_slope.geojson
        map.addLayer({
          id: "jalan-slope-layer",
          type: "line", // Jenis layer untuk menggambar garis jalan
          source: "jalan-slope",
          layout: {
            visibility: "visible",
          },
          paint: {
            "line-color": "#C5172E", // Warna garis jalan (misalnya biru)
            "line-width": 2, // Lebar garis
          },
        });

        // Menambahkan Source untuk faskes_barito_selatan.geojson
        map.addSource("faskes-barito-selatan", {
          type: "geojson",
          data: "assets/faskes_barito_selatan.geojson", // Path ke file GeoJSON kedua
        });
        map.loadImage(
          "assets/hospital.png", // Path ke ikon baru kamu
          function (error, image) {
            if (error) throw error;

            // Tambahkan icon ke map
            map.addImage("hospital-modern", image);

            // Setelah icon berhasil di-load, buat layernya
            map.addLayer({
              id: "faskes-markers",
              type: "symbol",
              source: "faskes-barito-selatan",
              layout: {
                visibility: "visible",
                "icon-image": "hospital-modern", // Pakai icon custom!
                "icon-size": 0.07, // Sesuaikan ukuran
                "icon-allow-overlap": true,
              },
            });
          }
        );

        // // Menambahkan markers untuk fasilitas kesehatan dengan ikon rumah sakit
        // map.addLayer({
        //   id: "faskes-markers",
        //   type: "symbol",
        //   source: "faskes-barito-selatan",
        //   layout: {
        //     visibility: "visible",
        //   },
        //   layout: {
        //     "icon-image": "cross-15", // Gunakan ikon rumah sakit bawaan Mapbox
        //     "icon-size": 1.5,
        //     "icon-allow-overlap": true,
        //   },
        // });
      });
      function addPopupOnClick(layerId, getContent) {
        map.on("click", layerId, function (e) {
          const coordinates = e.features[0].geometry.coordinates.slice();
          const properties = e.features[0].properties;
          const popupContent = getContent(properties);

          new mapboxgl.Popup()
            .setLngLat(coordinates)
            .setHTML(popupContent)
            .addTo(map);
        });

        // Ubah kursor jadi pointer kalau hover di layer
        map.on("mouseenter", layerId, function () {
          map.getCanvas().style.cursor = "pointer";
        });

        map.on("mouseleave", layerId, function () {
          map.getCanvas().style.cursor = "";
        });
      }

      addPopupOnClick(
        "points-layer",
        (properties) => `
  <div class="max-w-xs p-2 bg-white rounded-md shadow-md text-sm">
    <div class="font-semibold text-blue-600 mb-1">Skor Total Hasil Analisis</div>
    <div class="text-gray-800 text-center">${parseFloat(
      properties.skor_total
    ).toFixed(3)} </div>
  </div>
`
      );

      addPopupOnClick(
        "faskes-markers",
        (properties) => `
  <div class="max-w-xs p-2 bg-white rounded-md shadow-md text-sm">
    <div class="font-semibold text-red-600 mb-1">Fasilitas Kesehatan</div>
    <div class="text-gray-800">${properties.name || "Tidak diketahui"}</div>
  </div>
`
      );

      // Fungsi untuk memperbarui filter berdasarkan nilai min dan max
      function updateFilter() {
        const min = parseFloat(document.getElementById("minScore").value);
        const max = parseFloat(document.getElementById("maxScore").value);

        // Perbarui tampilan nilai slider
        document.getElementById("minScoreValue").textContent = min.toFixed(2);
        document.getElementById("maxScoreValue").textContent = max.toFixed(2);

        // Pastikan min tidak lebih besar dari max
        if (min > max) {
          alert("Skor minimum tidak boleh lebih besar dari skor maksimum.");
          return;
        }

        // Terapkan filter pada layer
        map.setFilter("points-layer", [
          "all",
          [">=", ["to-number", ["get", "skor_total"]], min],
          ["<=", ["to-number", ["get", "skor_total"]], max],
        ]);
      }

      // Fungsi untuk mereset filter
      function resetFilter() {
        document.getElementById("minScore").value = 0;
        document.getElementById("maxScore").value = 1;
        document.getElementById("minScoreValue").textContent = "0.00";
        document.getElementById("maxScoreValue").textContent = "1.00";
        map.setFilter("points-layer", null);
      }

      // Tambahkan event listener pada slider dan tombol reset
      document
        .getElementById("minScore")
        .addEventListener("input", updateFilter);
      document
        .getElementById("maxScore")
        .addEventListener("input", updateFilter);
      document
        .getElementById("resetFilter")
        .addEventListener("click", resetFilter);

      const layers = [
        {
          id: "administrasi-wilayah-layer",
          name: "Wilayah Administrasi",
          icon: "assets/wilayah.png", // Ganti ke gambar
        },
        {
          id: "jalan-slope-layer",
          name: "Jaringan Jalan",
          icon: "assets/jalan.png",
        },
        {
          id: "faskes-markers",
          name: "Fasilitas Kesehatan",
          icon: "assets/hospital.png",
        },
        {
          id: "points-layer",
          name: "Hasil Analisis",
          icon: "assets/akses.png",
        },
      ];

      const layerControl = document.createElement("div");
      layerControl.classList.add(
        "layer-control",
        "bg-white",
        "rounded-lg",
        "p-4",
        "shadow",
        "space-y-4"
      );
      document.getElementById("maps").appendChild(layerControl);

      layers.forEach((layer, index) => {
        const layerDiv = document.createElement("div");
        layerDiv.className = "flex items-center space-x-2";

        const layerCheckbox = document.createElement("input");
        layerCheckbox.type = "checkbox";
        layerCheckbox.checked = true;
        layerCheckbox.className = "form-checkbox h-4 w-4 text-blue-600";

        layerCheckbox.addEventListener("change", function () {
          map.setLayoutProperty(
            layer.id,
            "visibility",
            this.checked ? "visible" : "none"
          );
        });

        const layerIcon = document.createElement("img");
        layerIcon.src = layer.icon;
        layerIcon.alt = "Icon";
        layerIcon.className = "w-5 h-5 object-contain"; // Ukuran kecil, rapi

        const layerLabel = document.createElement("label");
        layerLabel.textContent = layer.name;
        layerLabel.className = "text-gray-700 text-sm";

        layerDiv.appendChild(layerCheckbox);
        layerDiv.appendChild(layerIcon);
        layerDiv.appendChild(layerLabel);
        layerControl.appendChild(layerDiv);

        // Divider, kecuali di terakhir
        if (index !== layers.length - 1) {
          const divider = document.createElement("div");
          divider.className = "border-b border-gray-300 my-2";
          layerControl.appendChild(divider);
        }
      });
    </script>
  </body>
</html>
